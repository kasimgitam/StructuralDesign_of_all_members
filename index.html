<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Complete Structural Design Verification</title>
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700&family=Montserrat:wght@400;600;700&family=Source+Code+Pro:wght@400;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>
    <style>
        :root {
            --primary: #2a5298;
            --secondary: #1e3c72;
            --accent: #4a90e2;
            --success: #4CAF50;
            --warning: #FFC107;
            --danger: #F44336;
            --light-bg: #f5f7fa;
            --card-bg: #ffffff;
            --text: #333333;
            --text-light: #666666;
        }
        
        body {
            font-family: 'Roboto', sans-serif;
            line-height: 1.6;
            color: var(--text);
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
            background-color: var(--light-bg);
        }
        
        header {
            background: linear-gradient(135deg, var(--secondary) 0%, var(--primary) 100%);
            color: white;
            padding: 2rem;
            border-radius: 8px;
            margin-bottom: 30px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        
        h1, h2, h3, h4 {
            font-family: 'Montserrat', sans-serif;
        }
        
        h1 {
            margin: 0;
            font-size: 2.5rem;
            font-weight: 700;
        }
        
        .subtitle {
            font-weight: 300;
            margin-top: 10px;
            font-size: 1.2rem;
        }
        
        .design-flow {
            display: flex;
            justify-content: space-between;
            margin: 30px 0;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
        }
        
        .flow-step {
            text-align: center;
            flex: 1;
            padding: 10px;
            position: relative;
        }
        
        .flow-step:not(:last-child):after {
            content: "‚Üí";
            position: absolute;
            right: -15px;
            top: 50%;
            transform: translateY(-50%);
            font-size: 24px;
            color: var(--primary);
        }
        
        .flow-icon {
            font-size: 24px;
            margin-bottom: 10px;
            color: var(--primary);
        }
        
        .card {
            background: var(--card-bg);
            border-radius: 8px;
            padding: 25px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.08);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            margin-bottom: 30px;
        }
        
        .card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.12);
        }
        
        .card h2 {
            color: var(--primary);
            border-bottom: 2px solid #eee;
            padding-bottom: 10px;
            margin-top: 0;
        }
        
        .design-section {
            margin-bottom: 40px;
        }
        
        table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            font-size: 0.95rem;
        }
        
        th, td {
            padding: 12px 15px;
            text-align: left;
            border-bottom: 1px solid #ddd;
        }
        
        th {
            background-color: #f8f9fa;
            font-weight: 600;
            color: var(--primary);
        }
        
        tr:hover {
            background-color: rgba(74, 144, 226, 0.05);
        }
        
        .input-section {
            background-color: #e8f4fc;
            padding: 25px;
            border-radius: 8px;
            margin-bottom: 30px;
        }
        
        .input-group {
            margin-bottom: 15px;
        }
        
        label {
            display: block;
            margin-bottom: 5px;
            font-weight: 500;
            color: var(--primary);
        }
        
        input, select {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 16px;
            font-family: 'Source Code Pro', monospace;
        }
        
        button {
            background: var(--primary);
            color: white;
            border: none;
            padding: 12px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 16px;
            transition: background 0.3s;
            margin-right: 10px;
            font-weight: 500;
        }
        
        button:hover {
            background: var(--secondary);
        }
        
        .btn-secondary {
            background: #6c757d;
        }
        
        .btn-secondary:hover {
            background: #5a6268;
        }
        
        .btn-success {
            background: var(--success);
        }
        
        .btn-success:hover {
            background: #3d8b40;
        }
        
        .btn-danger {
            background: var(--danger);
        }
        
        .btn-danger:hover {
            background: #d32f2f;
        }
        
        .results {
            background-color: #f0f8ff;
            padding: 25px;
            border-radius: 8px;
            margin-top: 30px;
        }
        
        footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: var(--text-light);
        }
        
        .loading {
            display: none;
            color: var(--primary);
            font-weight: bold;
            margin-top: 10px;
        }
        
        .calculation-steps {
            background-color: #f8f9fa;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            font-family: 'Source Code Pro', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }
        
        .check-mark {
            color: var(--success);
        }
        
        .warning-mark {
            color: var(--warning);
        }
        
        .error-mark {
            color: var(--danger);
        }
        
        .status-badge {
            padding: 3px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: bold;
        }
        
        .status-safe {
            background-color: #e8f5e9;
            color: var(--success);
        }
        
        .status-warning {
            background-color: #fff8e1;
            color: var(--warning);
        }
        
        .status-danger {
            background-color: #ffebee;
            color: var(--danger);
        }
        
        .print-only {
            display: none;
        }
        
        @media print {
            .no-print {
                display: none;
            }
            .print-only {
                display: block;
            }
            body {
                background-color: white;
                padding: 0;
                font-size: 12pt;
            }
            .card, .design-section {
                box-shadow: none;
                page-break-inside: avoid;
            }
            header {
                background: var(--primary);
                -webkit-print-color-adjust: exact;
                print-color-adjust: exact;
            }
        }
        
        .tab-container {
            margin-top: 20px;
        }
        
        .tab-buttons {
            display: flex;
            border-bottom: 1px solid #ddd;
            margin-bottom: 20px;
            flex-wrap: wrap;
        }
        
        .tab-button {
            padding: 10px 20px;
            cursor: pointer;
            background: #f1f1f1;
            border: none;
            margin-right: 5px;
            border-radius: 5px 5px 0 0;
            font-weight: 500;
        }
        
        .tab-button.active {
            background: var(--primary);
            color: white;
        }
        
        .tab-content {
            display: none;
        }
        
        .tab-content.active {
            display: block;
        }
        
        .design-actions {
            display: flex;
            justify-content: space-between;
            margin-top: 15px;
        }
        
        .size-adjuster {
            display: flex;
            align-items: center;
        }
        
        .size-adjuster button {
            padding: 5px 10px;
            margin: 0 5px;
            min-width: 40px;
        }
        
        .irregularity-check {
            background-color: #fff3e0;
            padding: 15px;
            border-radius: 6px;
            margin-top: 15px;
            border-left: 4px solid var(--warning);
        }
        
        .modal {
            display: none;
            position: fixed;
            z-index: 100;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.4);
        }
        
        .modal-content {
            background-color: #fefefe;
            margin: 5% auto;
            padding: 20px;
            border: 1px solid #888;
            width: 80%;
            max-width: 900px;
            border-radius: 8px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        .close {
            color: #aaa;
            float: right;
            font-size: 28px;
            font-weight: bold;
            cursor: pointer;
        }
        
        .close:hover {
            color: black;
        }
        
        .report-section {
            margin-bottom: 30px;
        }
        
        .download-btn {
            background: var(--success);
            color: white;
        }
        
        .download-btn:hover {
            background: #388e3c;
        }

        .calculation-actions {
            margin-top: 15px;
            text-align: right;
        }

        .soil-type-selector {
            display: flex;
            margin-bottom: 15px;
        }

        .soil-type-option {
            flex: 1;
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
            cursor: pointer;
            margin-right: 5px;
            border-radius: 4px;
        }

        .soil-type-option.selected {
            background-color: var(--primary);
            color: white;
            border-color: var(--primary);
        }

        .soil-type-option:last-child {
            margin-right: 0;
        }

        .foundation-type {
            font-weight: bold;
            color: var(--primary);
            margin: 10px 0;
        }

        .cover-details {
            background-color: #f5f7fa;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
            font-size: 0.9rem;
        }
    </style>
</head>
<body>
    <header>
        <h1>Complete Structural Design Verification</h1>
        <p class="subtitle">IS 456:2000 & IS 1893:2016 Compliance with Load Path Analysis</p>
    </header>

    <div class="design-flow no-print">
        <div class="flow-step">
            <div class="flow-icon">üèóÔ∏è</div>
            <h3>Slab Design</h3>
            <p>Thickness: <span id="flow-slab-thickness">150</span>mm</p>
            <div id="flow-slab-status" class="status-badge status-safe">Safe</div>
        </div>
        <div class="flow-step">
            <div class="flow-icon">üìè</div>
            <h3>Beam Design</h3>
            <p>Size: <span id="flow-beam-size">300√ó600</span>mm</p>
            <div id="flow-beam-status" class="status-badge status-safe">Safe</div>
        </div>
        <div class="flow-step">
            <div class="flow-icon">üè¢</div>
            <h3>Column Design</h3>
            <p>Size: <span id="flow-column-size">300√ó600</span>mm</p>
            <div id="flow-column-status" class="status-badge status-safe">Safe</div>
        </div>
        <div class="flow-step">
            <div class="flow-icon">‚õèÔ∏è</div>
            <h3>Footing Design</h3>
            <p>Size: <span id="flow-footing-size">1.5√ó1.5</span>m</p>
            <div id="flow-footing-status" class="status-badge status-safe">Safe</div>
        </div>
    </div>

    <div class="input-section no-print">
        <h2>Global Parameters</h2>
        <div class="container">
            <div>
                <div class="input-group">
                    <label for="concreteGrade">Concrete Grade</label>
                    <select id="concreteGrade" onchange="updateAllDesigns()">
                        <option value="20">M20</option>
                        <option value="25" selected>M25</option>
                        <option value="30">M30</option>
                        <option value="35">M35</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="steelGrade">Steel Grade</label>
                    <select id="steelGrade" onchange="updateAllDesigns()">
                        <option value="415" selected>Fe415</option>
                        <option value="500">Fe500</option>
                        <option value="550">Fe550</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="floorHeight">Floor Height (m)</label>
                    <input type="number" id="floorHeight" value="3.0" step="0.1" oninput="updateAllDesigns()">
                </div>
                
                <div class="input-group">
                    <label for="seismicZone">Seismic Zone</label>
                    <select id="seismicZone" onchange="updateAllDesigns()">
                        <option value="0.1">Zone II</option>
                        <option value="0.16" selected>Zone III</option>
                        <option value="0.24">Zone IV</option>
                        <option value="0.36">Zone V</option>
                    </select>
                </div>
            </div>
            <div>
                <div class="input-group">
                    <label for="liveLoad">Live Load (kN/m¬≤)</label>
                    <input type="number" id="liveLoad" value="3.0" step="0.1" oninput="updateAllDesigns()">
                </div>
                
                <div class="input-group">
                    <label for="floorFinishLoad">Floor Finish Load (kN/m¬≤)</label>
                    <input type="number" id="floorFinishLoad" value="1.0" step="0.1" oninput="updateAllDesigns()">
                </div>
                
                <div class="input-group">
                    <label for="wallLoad">Wall Load (kN/m)</label>
                    <input type="number" id="wallLoad" value="12.0" step="0.1" oninput="updateAllDesigns()">
                </div>
                
                <div class="input-group">
                    <label for="soilCapacity">Soil Bearing Capacity (kN/m¬≤)</label>
                    <input type="number" id="soilCapacity" value="150" step="5" oninput="updateAllDesigns()">
                </div>
            </div>
        </div>
        
        <div class="input-group no-print">
            <button onclick="runFullVerification()" class="btn-success">Run Full Verification</button>
            <button onclick="generateReport()" class="btn-secondary">Generate Design Report</button>
            <button onclick="window.print()" class="btn-secondary">Print Report</button>
            <button onclick="downloadPDF()" class="download-btn">Download PDF</button>
            <div id="loadingIndicator" class="loading">Performing structural calculations...</div>
        </div>
    </div>

    <div class="tab-container no-print">
        <div class="tab-buttons">
            <button class="tab-button active" onclick="openTab(event, 'slab')">Slab Design</button>
            <button class="tab-button" onclick="openTab(event, 'beam')">Beam Design</button>
            <button class="tab-button" onclick="openTab(event, 'column')">Column Design</button>
            <button class="tab-button" onclick="openTab(event, 'footing')">Footing Design</button>
            <button class="tab-button" onclick="openTab(event, 'torsion')">Torsional Checks</button>
            <button class="tab-button" onclick="openTab(event, 'irregularity')">Irregularity Checks</button>
        </div>
        
        <div id="slab" class="tab-content active">
            <div class="design-section">
                <h2>Slab Design Parameters</h2>
                <div class="input-group">
                    <label for="slabThickness">Slab Thickness (mm)</label>
                    <div class="size-adjuster">
                        <button onclick="adjustSlabThickness(-10)">-10</button>
                        <input type="number" id="slabThickness" value="150" oninput="updateSlabDesign()">
                        <button onclick="adjustSlabThickness(10)">+10</button>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="slabSpanX">Short Span (m)</label>
                    <input type="number" id="slabSpanX" value="5.0" step="0.1" oninput="updateSlabDesign()">
                </div>
                
                <div class="input-group">
                    <label for="slabSpanY">Long Span (m)</label>
                    <input type="number" id="slabSpanY" value="6.0" step="0.1" oninput="updateSlabDesign()">
                </div>

                <div class="input-group">
                    <label for="slabSupportCondition">Support Condition</label>
                    <select id="slabSupportCondition" onchange="updateSlabDesign()">
                        <option value="all">All Edges Continuous</option>
                        <option value="twoAdjacent">Two Adjacent Edges Discontinuous</option>
                        <option value="oneLong">One Long Edge Discontinuous</option>
                        <option value="oneShort">One Short Edge Discontinuous</option>
                        <option value="allDiscontinuous">All Edges Discontinuous</option>
                    </select>
                </div>
                
                <div class="results">
                    <h3>Design Verification</h3>
                    <table>
                        <tr>
                            <th>Check</th>
                            <th>Value</th>
                            <th>Limit</th>
                            <th>Status</th>
                        </tr>
                        <tr>
                            <td>Moment Capacity (X)</td>
                            <td id="slabMomentX">12.5 kNm/m</td>
                            <td id="slabMomentXLimit">15.2 kNm/m</td>
                            <td id="slabMomentXStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Moment Capacity (Y)</td>
                            <td id="slabMomentY">8.2 kNm/m</td>
                            <td id="slabMomentYLimit">12.8 kNm/m</td>
                            <td id="slabMomentYStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Deflection</td>
                            <td id="slabDeflection">L/325</td>
                            <td>L/250</td>
                            <td id="slabDeflectionStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Shear Capacity</td>
                            <td id="slabShear">45.6 kN/m</td>
                            <td id="slabShearLimit">52.3 kN/m</td>
                            <td id="slabShearStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                    </table>
                    
                    <div class="calculation-steps">
                        <h4>Load Calculation</h4>
                        <p>Self weight = 0.15 √ó 25 = 3.75 kN/m¬≤</p>
                        <p>Finishes = 1.0 kN/m¬≤</p>
                        <p>Live load = 3.0 kN/m¬≤</p>
                        <p>Total factored load = 1.5 √ó (3.75 + 1.0 + 3.0) = 11.625 kN/m¬≤</p>
                        
                        <h4>Moment Calculation (IS 456:2000)</h4>
                        <p>Ly/Lx = 6.0/5.0 = 1.2 ‚Üí Œ±x = 0.072, Œ±y = 0.056 (Table 26)</p>
                        <p>Mx = 0.072 √ó 11.625 √ó 5.0¬≤ = 20.93 kNm/m</p>
                        <p>My = 0.056 √ó 11.625 √ó 5.0¬≤ = 16.28 kNm/m</p>
                        
                        <h4>Reinforcement Calculation</h4>
                        <p>For Mx = 20.93 kNm/m:</p>
                        <p>Mu/bd¬≤ = (20.93√ó10‚Å∂)/(1000√ó125¬≤) = 1.34</p>
                        <p>From SP 16, pt = 0.387%</p>
                        <p>Ast required = (0.387/100) √ó 1000 √ó 125 = 484 mm¬≤/m</p>
                        <p>Provide 10mm dia @ 160mm c/c (Ast provided = 491 mm¬≤/m)</p>

                        <div class="cover-details">
                            <h4>Cover Details (IS 456:2000 Clause 26.4)</h4>
                            <p>Nominal cover for slab = 20mm (Mild exposure)</p>
                            <p>Effective depth (d) = Overall depth (D) - Cover - Half of bar diameter</p>
                            <p>For 10mm bars: d = 150 - 20 - 5 = 125mm</p>
                        </div>
                    </div>
                    
                    <div class="design-actions">
                        <div>
                            <h4>Reinforcement Details</h4>
                            <p>X-direction: <span id="slabReinforcementX">10mm @ 150mm c/c</span></p>
                            <p>Y-direction: <span id="slabReinforcementY">10mm @ 180mm c/c</span></p>
                        </div>
                        <div>
                            <button onclick="optimizeSlab()" class="btn-success">Optimize Slab</button>
                            <button onclick="downloadSlabCalculations()" class="download-btn">Download Calculations</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="beam" class="tab-content">
            <div class="design-section">
                <h2>Beam Design Parameters</h2>
                <div class="input-group">
                    <label for="beamWidth">Beam Width (mm)</label>
                    <div class="size-adjuster">
                        <button onclick="adjustBeamWidth(-25)">-25</button>
                        <input type="number" id="beamWidth" value="300" oninput="updateBeamDesign()">
                        <button onclick="adjustBeamWidth(25)">+25</button>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="beamDepth">Beam Depth (mm)</label>
                    <div class="size-adjuster">
                        <button onclick="adjustBeamDepth(-25)">-25</button>
                        <input type="number" id="beamDepth" value="600" oninput="updateBeamDesign()">
                        <button onclick="adjustBeamDepth(25)">+25</button>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="beamSpan">Beam Span (m)</label>
                    <input type="number" id="beamSpan" value="6.0" step="0.1" oninput="updateBeamDesign()">
                </div>

                <div class="input-group">
                    <label for="beamSupportCondition">Support Condition</label>
                    <select id="beamSupportCondition" onchange="updateBeamDesign()">
                        <option value="simplySupported">Simply Supported</option>
                        <option value="continuous">Continuous</option>
                        <option value="cantilever">Cantilever</option>
                        <option value="fixed">Fixed at Both Ends</option>
                    </select>
                </div>
                
                <div class="results">
                    <h3>Design Verification</h3>
                    <table>
                        <tr>
                            <th>Check</th>
                            <th>Value</th>
                            <th>Limit</th>
                            <th>Status</th>
                        </tr>
                        <tr>
                            <td>Moment Capacity</td>
                            <td id="beamMoment">145.3 kNm</td>
                            <td id="beamMomentLimit">162.8 kNm</td>
                            <td id="beamMomentStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Shear Capacity</td>
                            <td id="beamShear">85.6 kN</td>
                            <td id="beamShearLimit">92.4 kN</td>
                            <td id="beamShearStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Deflection</td>
                            <td id="beamDeflection">L/350</td>
                            <td>L/250</td>
                            <td id="beamDeflectionStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Ductility Check</td>
                            <td id="beamDuctility">0.48</td>
                            <td>‚â§ 0.48 (IS 13920)</td>
                            <td id="beamDuctilityStatus"><span class="status-badge status-safe">OK</span></td>
                        </tr>
                    </table>
                    
                    <div class="calculation-steps">
                        <h4>Load Calculation</h4>
                        <p>From slab (tributary area): 11.625 √ó (6.0/2) = 34.88 kN/m</p>
                        <p>Self weight = 0.3 √ó 0.6 √ó 25 = 4.5 kN/m</p>
                        <p>Wall load = 12.0 kN/m</p>
                        <p>Total factored load = 1.5 √ó (34.88 + 4.5 + 12.0) = 77.07 kN/m</p>
                        
                        <h4>Moment & Shear (IS 456:2000)</h4>
                        <p>Moment = wl¬≤/8 = 77.07 √ó 6.0¬≤ / 8 = 346.8 kNm</p>
                        <p>Shear = wl/2 = 77.07 √ó 6.0 / 2 = 231.2 kN</p>
                        
                        <h4>Reinforcement Calculation</h4>
                        <p>Mu/bd¬≤ = (346.8√ó10‚Å∂)/(300√ó550¬≤) = 3.81</p>
                        <p>From SP 16, pt = 1.21% (Fe415, M25)</p>
                        <p>Ast required = (1.21/100) √ó 300 √ó 550 = 1997 mm¬≤</p>
                        <p>Provide 4-25mm dia bars (Ast provided = 1964 mm¬≤)</p>
                        <p>Shear reinforcement:</p>
                        <p>œÑv = Vu/bd = 231.2√ó10¬≥/(300√ó550) = 1.40 MPa</p>
                        <p>œÑc = 0.64 MPa (For M25 and pt=1.21%)</p>
                        <p>Shear to be carried by stirrups = œÑv - œÑc = 1.40 - 0.64 = 0.76 MPa</p>
                        <p>Provide 2-legged 8mm dia stirrups @ 150mm c/c</p>

                        <div class="cover-details">
                            <h4>Cover Details (IS 456:2000 Clause 26.4)</h4>
                            <p>Nominal cover for beam = 25mm (Moderate exposure)</p>
                            <p>Effective depth (d) = Overall depth (D) - Cover - Stirrup dia - Half of bar diameter</p>
                            <p>For 25mm bars and 8mm stirrups: d = 600 - 25 - 8 - 12.5 = 554.5mm (taken as 550mm)</p>
                        </div>
                    </div>
                    
                    <div class="design-actions">
                        <div>
                            <h4>Reinforcement Details</h4>
                            <p>Main bars: <span id="beamMainReinforcement">4-25mm dia (top & bottom)</span></p>
                            <p>Stirrups: <span id="beamStirrups">8mm @ 150mm c/c</span></p>
                        </div>
                        <div>
                            <button onclick="optimizeBeam()" class="btn-success">Optimize Beam</button>
                            <button onclick="downloadBeamCalculations()" class="download-btn">Download Calculations</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="column" class="tab-content">
            <div class="design-section">
                <h2>Column Design Parameters</h2>
                <div class="input-group">
                    <label for="columnWidth">Column Width (mm)</label>
                    <div class="size-adjuster">
                        <button onclick="adjustColumnWidth(-25)">-25</button>
                        <input type="number" id="columnWidth" value="300" oninput="updateColumnDesign()">
                        <button onclick="adjustColumnWidth(25)">+25</button>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="columnDepth">Column Depth (mm)</label>
                    <div class="size-adjuster">
                        <button onclick="adjustColumnDepth(-25)">-25</button>
                        <input type="number" id="columnDepth" value="450" oninput="updateColumnDesign()">
                        <button onclick="adjustColumnDepth(25)">+25</button>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="columnHeight">Column Height (m)</label>
                    <input type="number" id="columnHeight" value="3.0" step="0.1" oninput="updateColumnDesign()">
                </div>

                <div class="input-group">
                    <label for="columnType">Column Type</label>
                    <select id="columnType" onchange="updateColumnDesign()">
                        <option value="tied">Tied Column</option>
                        <option value="spiral">Spiral Column</option>
                    </select>
                </div>
                
                <div class="results">
                    <h3>Design Verification</h3>
                    <table>
                        <tr>
                            <th>Check</th>
                            <th>Value</th>
                            <th>Limit</th>
                            <th>Status</th>
                        </tr>
                        <tr>
                            <td>Axial Load</td>
                            <td id="columnAxial">1200 kN</td>
                            <td id="columnAxialLimit">1850 kN</td>
                            <td id="columnAxialStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Moment Capacity (X)</td>
                            <td id="columnMomentX">45.2 kNm</td>
                            <td id="columnMomentXLimit">68.4 kNm</td>
                            <td id="columnMomentXStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Moment Capacity (Y)</td>
                            <td id="columnMomentY">32.7 kNm</td>
                            <td id="columnMomentYLimit">52.7 kNm</td>
                            <td id="columnMomentYStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Slenderness Ratio</td>
                            <td id="columnSlenderness">12.5</td>
                            <td>‚â§12 (short)</td>
                            <td id="columnSlendernessStatus"><span class="status-badge status-warning">Check</span></td>
                        </tr>
                        <tr>
                            <td>Ductility Check</td>
                            <td id="columnDuctility">0.035</td>
                            <td>‚â• 0.035 (IS 13920)</td>
                            <td id="columnDuctilityStatus"><span class="status-badge status-safe">OK</span></td>
                        </tr>
                    </table>
                    
                    <div class="calculation-steps">
                        <h4>Load Calculation</h4>
                        <p>From beams (tributary area): 2 √ó 231.2 kN = 462.4 kN</p>
                        <p>Self weight = 0.3 √ó 0.45 √ó 3.0 √ó 25 = 10.1 kN</p>
                        <p>Total factored load = 1.5 √ó (462.4 + 10.1) = 708.8 kN</p>
                        <p>Moments from ETABS analysis: Mx = 45.2 kNm, My = 32.7 kNm</p>
                        
                        <h4>Slenderness Check (IS 456:2000)</h4>
                        <p>Effective length factor = 0.65 (braced)</p>
                        <p>Effective length = 0.65 √ó 3.0 = 1.95 m</p>
                        <p>Œªx = 1950/450 = 4.33, Œªy = 1950/300 = 6.5</p>
                        
                        <h4>Reinforcement Calculation</h4>
                        <p>Minimum reinforcement = 0.8% of gross area (IS 13920)</p>
                        <p>Ast required = 0.008 √ó 300 √ó 450 = 1080 mm¬≤</p>
                        <p>Provide 6-16mm dia bars (Ast provided = 1206 mm¬≤)</p>
                        <p>Special confining reinforcement as per IS 13920:</p>
                        <p>Provide 8mm dia ties @ 100mm c/c in potential hinge zones</p>

                        <div class="cover-details">
                            <h4>Cover Details (IS 456:2000 Clause 26.4)</h4>
                            <p>Nominal cover for column = 40mm (Moderate exposure)</p>
                            <p>For seismic design, cover should not be less than 40mm (IS 13920 Clause 7.1.3)</p>
                            <p>Spacing of ties should not exceed:</p>
                            <p>- Least lateral dimension = 300mm</p>
                            <p>- 16 √ó smallest longitudinal bar = 16 √ó 16 = 256mm</p>
                            <p>- 300mm</p>
                        </div>
                    </div>
                    
                    <div class="design-actions">
                        <div>
                            <h4>Reinforcement Details</h4>
                            <p>Main bars: <span id="columnMainReinforcement">6-16mm dia</span></p>
                            <p>Ties: <span id="columnTies">8mm @ 100mm c/c (hinge zones)</span></p>
                        </div>
                        <div>
                            <button onclick="optimizeColumn()" class="btn-success">Optimize Column</button>
                            <button onclick="downloadColumnCalculations()" class="download-btn">Download Calculations</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="footing" class="tab-content">
            <div class="design-section">
                <h2>Footing Design Parameters</h2>
                <div class="input-group">
                    <label for="footingLength">Footing Length (m)</label>
                    <div class="size-adjuster">
                        <button onclick="adjustFootingLength(-0.1)">-0.1</button>
                        <input type="number" id="footingLength" value="1.5" step="0.1" oninput="updateFootingDesign()">
                        <button onclick="adjustFootingLength(0.1)">+0.1</button>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="footingWidth">Footing Width (m)</label>
                    <div class="size-adjuster">
                        <button onclick="adjustFootingWidth(-0.1)">-0.1</button>
                        <input type="number" id="footingWidth" value="1.5" step="0.1" oninput="updateFootingDesign()">
                        <button onclick="adjustFootingWidth(0.1)">+0.1</button>
                    </div>
                </div>
                
                <div class="input-group">
                    <label for="footingThickness">Footing Thickness (mm)</label>
                    <div class="size-adjuster">
                        <button onclick="adjustFootingThickness(-25)">-25</button>
                        <input type="number" id="footingThickness" value="450" oninput="updateFootingDesign()">
                        <button onclick="adjustFootingThickness(25)">+25</button>
                    </div>
                </div>

                <div class="input-group">
                    <label>Soil Type</label>
                    <div class="soil-type-selector">
                        <div class="soil-type-option selected" onclick="selectSoilType(this, 'hard')">Hard Soil</div>
                        <div class="soil-type-option" onclick="selectSoilType(this, 'medium')">Medium Soil</div>
                        <div class="soil-type-option" onclick="selectSoilType(this, 'soft')">Soft Soil</div>
                    </div>
                    <input type="hidden" id="soilType" value="hard" onchange="updateFootingDesign()">
                </div>

                <div id="foundationTypeDisplay" class="foundation-type">Foundation Type: Shallow Foundation (Recommended)</div>
                
                <div class="results">
                    <h3>Design Verification</h3>
                    <table>
                        <tr>
                            <th>Check</th>
                            <th>Value</th>
                            <th>Limit</th>
                            <th>Status</th>
                        </tr>
                        <tr>
                            <td>Soil Pressure</td>
                            <td id="footingPressure">320 kN/m¬≤</td>
                            <td id="footingPressureLimit">150 kN/m¬≤</td>
                            <td id="footingPressureStatus"><span class="status-badge status-danger">Fail</span></td>
                        </tr>
                        <tr>
                            <td>Moment Capacity</td>
                            <td id="footingMoment">45.2 kNm/m</td>
                            <td id="footingMomentLimit">68.4 kNm/m</td>
                            <td id="footingMomentStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Shear Capacity</td>
                            <td id="footingShear">125.6 kN/m</td>
                            <td id="footingShearLimit">185.3 kN/m</td>
                            <td id="footingShearStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                        <tr>
                            <td>Punching Shear</td>
                            <td id="footingPunching">850 kN</td>
                            <td id="footingPunchingLimit">1200 kN</td>
                            <td id="footingPunchingStatus"><span class="status-badge status-safe">Safe</span></td>
                        </tr>
                    </table>
                    
                    <div class="calculation-steps">
                        <h4>Load Calculation</h4>
                        <p>Column load = 708.8 kN (from column design)</p>
                        <p>Self weight = 1.5 √ó 1.5 √ó 0.45 √ó 25 = 25.3 kN</p>
                        <p>Total load = 708.8 + 25.3 = 734.1 kN</p>
                        
                        <h4>Soil Pressure (IS 456:2000)</h4>
                        <p>Area = 1.5 √ó 1.5 = 2.25 m¬≤</p>
                        <p>Pressure = 734.1 / 2.25 = 326.3 kN/m¬≤</p>
                        <p>Allowable pressure = 150 kN/m¬≤ (from input)</p>
                        
                        <h4>Reinforcement Calculation</h4>
                        <p>Cantilever length = (1.5 - 0.45)/2 = 0.525 m</p>
                        <p>Moment = 1.5 √ó 150 √ó 0.525¬≤ / 2 = 31.0 kNm/m</p>
                        <p>Mu/bd¬≤ = (31.0√ó10‚Å∂)/(1000√ó400¬≤) = 0.194</p>
                        <p>From SP 16, pt = 0.056% (min 0.12%)</p>
                        <p>Provide 12mm dia @ 150mm c/c both ways (Ast = 754 mm¬≤/m)</p>

                        <div class="cover-details">
                            <h4>Cover Details (IS 456:2000 Clause 26.4)</h4>
                            <p>Nominal cover for footing = 50mm (Severe exposure)</p>
                            <p>Effective depth (d) = Overall depth (D) - Cover - Half of bar diameter</p>
                            <p>For 12mm bars: d = 450 - 50 - 6 = 394mm (taken as 400mm)</p>
                        </div>

                        <div id="foundationRecommendations" class="irregularity-check">
                            <h4>Foundation Recommendations</h4>
                            <p id="foundationRecText">For hard soil with bearing capacity of 150 kN/m¬≤, isolated footing is recommended.</p>
                            <p>Minimum depth of foundation as per IS 1904:</p>
                            <p>- For hard soil: 0.6m to 0.9m</p>
                            <p>- For medium soil: 0.9m to 1.2m</p>
                            <p>- For soft soil: Consider pile foundation if depth exceeds 1.5m</p>
                        </div>
                    </div>
                    
                    <div class="design-actions">
                        <div>
                            <h4>Reinforcement Details</h4>
                            <p>Bottom: <span id="footingBottomReinforcement">12mm @ 150mm c/c both ways</span></p>
                            <p>Top: <span id="footingTopReinforcement">12mm @ 200mm c/c both ways</span></p>
                        </div>
                        <div>
                            <button onclick="optimizeFooting()" class="btn-success">Optimize Footing</button>
                            <button onclick="downloadFootingCalculations()" class="download-btn">Download Calculations</button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="torsion" class="tab-content">
            <div class="design-section">
                <h2>Torsional Irregularity Checks (IS 1893:2016)</h2>
                
                <div class="input-group">
                    <label for="buildingLengthX">Building Length in X-direction (m)</label>
                    <input type="number" id="buildingLengthX" value="30.0" step="1.0" oninput="updateTorsionChecks()">
                </div>
                
                <div class="input-group">
                    <label for="buildingWidthY">Building Width in Y-direction (m)</label>
                    <input type="number" id="buildingWidthY" value="20.0" step="1.0" oninput="updateTorsionChecks()">
                </div>
                
                <div class="input-group">
                    <label for="centerMassX">Center of Mass X (m)</label>
                    <input type="number" id="centerMassX" value="15.0" step="0.1" oninput="updateTorsionChecks()">
                </div>
                
                <div class="input-group">
                    <label for="centerMassY">Center of Mass Y (m)</label>
                    <input type="number" id="centerMassY" value="10.0" step="0.1" oninput="updateTorsionChecks()">
                </div>
                
                <div class="input-group">
                    <label for="centerStiffnessX">Center of Stiffness X (m)</label>
                    <input type="number" id="centerStiffnessX" value="14.2" step="0.1" oninput="updateTorsionChecks()">
                </div>
                
                <div class="input-group">
                    <label for="centerStiffnessY">Center of Stiffness Y (m)</label>
                    <input type="number" id="centerStiffnessY" value="9.8" step="0.1" oninput="updateTorsionChecks()">
                </div>
                
                <div class="results">
                    <h3>Torsional Irregularity Verification</h3>
                    <table>
                        <tr>
                            <th>Parameter</th>
                            <th>X-direction</th>
                            <th>Y-direction</th>
                            <th>Limit (IS 1893:2016)</th>
                            <th>Status</th>
                        </tr>
                        <tr>
                            <td>Eccentricity</td>
                            <td id="eccentricityX">0.8 m</td>
                            <td id="eccentricityY">0.2 m</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td>Radius of Gyration</td>
                            <td id="radiusX">6.0 m</td>
                            <td id="radiusY">4.0 m</td>
                            <td>-</td>
                            <td>-</td>
                        </tr>
                        <tr>
                            <td>Torsional Irregularity Ratio</td>
                            <td id="torsionRatioX">0.133</td>
                            <td id="torsionRatioY">0.050</td>
                            <td>‚â§ 0.15 (Regular)</td>
                            <td id="torsionStatus"><span class="status-badge status-safe">Regular</span></td>
                        </tr>
                    </table>
                    
                    <div class="calculation-steps">
                        <h4>Calculations (Clause 7.1)</h4>
                        <p>Eccentricity in X direction = |CMx - CSx| = |15.0 - 14.2| = 0.8 m</p>
                        <p>Eccentricity in Y direction = |CMy - CSy| = |10.0 - 9.8| = 0.2 m</p>
                        <p>Radius of gyration (rx) = 0.2 √ó Building Length = 0.2 √ó 30 = 6.0 m</p>
                        <p>Radius of gyration (ry) = 0.2 √ó Building Width = 0.2 √ó 20 = 4.0 m</p>
                        <p>Torsional irregularity ratio X = ex/rx = 0.8/6.0 = 0.133</p>
                        <p>Torsional irregularity ratio Y = ey/ry = 0.2/4.0 = 0.050</p>
                        <p>Maximum ratio = 0.133 < 0.15 ‚Üí Structure is torsionally regular</p>
                    </div>
                    
                    <div class="irregularity-check" id="torsionRecommendations" style="display: none;">
                        <h4>Recommendations for Torsionally Irregular Structures</h4>
                        <p>1. Increase stiffness of perimeter elements</p>
                        <p>2. Add shear walls at building corners</p>
                        <p>3. Consider 25% increase in design forces (Clause 7.1)</p>
                        <p>4. Perform dynamic analysis as per Clause 7.8.2</p>
                    </div>

                    <div class="calculation-actions">
                        <button onclick="downloadTorsionCalculations()" class="download-btn">Download Calculations</button>
                    </div>
                </div>
            </div>
        </div>
        
        <div id="irregularity" class="tab-content">
            <div class="design-section">
                <h2>Structural Irregularity Checks (IS 1893:2016)</h2>
                
                <div class="input-group">
                    <label for="massIrregularity">Mass Irregularity (Weight difference between adjacent floors > 200%)</label>
                    <select id="massIrregularity" onchange="updateIrregularityChecks()">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="verticalGeometricIrregularity">Vertical Geometric Irregularity (Lateral dimension > 130% of adjacent floor)</label>
                    <select id="verticalGeometricIrregularity" onchange="updateIrregularityChecks()">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="stiffnessIrregularity">Stiffness Irregularity (Stiffness < 70% of storey above or < 80% of average stiffness of 3 storeys above)</label>
                    <select id="stiffnessIrregularity" onchange="updateIrregularityChecks()">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="verticalDiscontinuity">Vertical Discontinuity (In-plane discontinuity in lateral load resisting elements)</label>
                    <select id="verticalDiscontinuity" onchange="updateIrregularityChecks()">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label for="reentrantCorners">Re-entrant Corners (Plan projections > 15% of plan dimension in either direction)</label>
                    <select id="reentrantCorners" onchange="updateIrregularityChecks()">
                        <option value="no">No</option>
                        <option value="yes">Yes</option>
                    </select>
                </div>
                
                <div class="results">
                    <h3>Irregularity Status</h3>
                    <table>
                        <tr>
                            <th>Irregularity Type</th>
                            <th>Present</th>
                            <th>Clause</th>
                            <th>Implications</th>
                            <th>Status</th>
                        </tr>
                        <tr>
                            <td>Torsional Irregularity</td>
                            <td id="torsionIrregularityPresent">No</td>
                            <td>7.1</td>
                            <td>25% increase in forces</td>
                            <td id="torsionIrregularityStatus"><span class="status-badge status-safe">OK</span></td>
                        </tr>
                        <tr>
                            <td>Mass Irregularity</td>
                            <td id="massIrregularityPresent">No</td>
                            <td>7.2.1</td>
                            <td>Dynamic analysis required</td>
                            <td id="massIrregularityStatus"><span class="status-badge status-safe">OK</span></td>
                        </tr>
                        <tr>
                            <td>Vertical Geometric Irregularity</td>
                            <td id="verticalGeometricIrregularityPresent">No</td>
                            <td>7.2.2</td>
                            <td>Dynamic analysis required</td>
                            <td id="verticalGeometricIrregularityStatus"><span class="status-badge status-safe">OK</span></td>
                        </tr>
                        <tr>
                            <td>Stiffness Irregularity (Soft Storey)</td>
                            <td id="stiffnessIrregularityPresent">No</td>
                            <td>7.2.3</td>
                            <td>Special design provisions</td>
                            <td id="stiffnessIrregularityStatus"><span class="status-badge status-safe">OK</span></td>
                        </tr>
                        <tr>
                            <td>Vertical Discontinuity</td>
                            <td id="verticalDiscontinuityPresent">No</td>
                            <td>7.2.4</td>
                            <td>Transfer elements required</td>
                            <td id="verticalDiscontinuityStatus"><span class="status-badge status-safe">OK</span></td>
                        </tr>
                        <tr>
                            <td>Re-entrant Corners</td>
                            <td id="reentrantCornersPresent">No</td>
                            <td>7.3</td>
                            <td>Diaphragm discontinuity</td>
                            <td id="reentrantCornersStatus"><span class="status-badge status-safe">OK</span></td>
                        </tr>
                    </table>
                    
                    <div class="irregularity-check" id="irregularityRecommendations" style="display: none;">
                        <h4>Recommendations for Irregular Structures</h4>
                        <p>1. Perform dynamic analysis as per Clause 7.8.2</p>
                        <p>2. Consider 25% increase in design forces for torsionally irregular structures</p>
                        <p>3. Provide special detailing for soft storeys as per IS 13920</p>
                        <p>4. Ensure proper load transfer for vertical discontinuities</p>
                        <p>5. Provide collector elements for re-entrant corners</p>
                    </div>

                    <div class="calculation-actions">
                        <button onclick="downloadIrregularityCalculations()" class="download-btn">Download Calculations</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Report Modal -->
    <div id="reportModal" class="modal">
        <div class="modal-content">
            <span class="close" onclick="closeModal()">&times;</span>
            <div id="modalReportContent"></div>
            <div style="text-align: center; margin-top: 20px;">
                <button onclick="window.print()" class="btn-secondary">Print Report</button>
                <button onclick="downloadPDF()" class="download-btn">Download PDF</button>
            </div>
        </div>
    </div>

    <div id="report" class="print-only">
        <h1>Structural Design Verification Report</h1>
        <p class="subtitle">Generated on <span id="reportDate"></span></p>
        
        <h2>Project Information</h2>
        <table>
            <tr>
                <th>Project Name:</th>
                <td>Sample Building Project</td>
            </tr>
            <tr>
                <th>Location:</th>
                <td>Mumbai, India</td>
            </tr>
            <tr>
                <th>Seismic Zone:</th>
                <td id="reportSeismicZone">III</td>
            </tr>
            <tr>
                <th>Software Used:</th>
                <td>ETABS v20</td>
            </tr>
        </table>
        
        <div class="report-section">
            <h2>Design Summary</h2>
            <div id="reportSummary"></div>
        </div>
        
        <div class="report-section">
            <h2>Detailed Calculations</h2>
            <div id="reportCalculations"></div>
        </div>
        
        <div class="report-section">
            <h2>Irregularity Checks</h2>
            <div id="reportIrregularity"></div>
        </div>
        
        <div class="report-section">
            <h2>Conclusion</h2>
            <p>The structure has been verified and meets all design requirements according to IS 456:2000 and IS 1893:2016.</p>
        </div>
        
        <div style="margin-top: 50px;">
            <p>Prepared by:</p>
            <p>___________________________</p>
            <p>Licensed Structural Engineer</p>
        </div>
    </div>

    <footer class="no-print">
        <p>Complete Structural Design Verification Tool | ¬© 2023</p>
    </footer>

    <script>
        // Initialize jsPDF
        const { jsPDF } = window.jspdf;
        
        // Global design data
        let designData = {
            slab: {},
            beam: {},
            column: {},
            footing: {},
            torsion: {},
            irregularity: {},
            materials: {},
            loading: {}
        };
        
        // Initialize all designs
        function initializeDesigns() {
            updateMaterialProperties();
            updateLoadingConditions();
            updateSlabDesign();
            updateBeamDesign();
            updateColumnDesign();
            updateFootingDesign();
            updateTorsionChecks();
            updateIrregularityChecks();
            updateFlowDiagram();
        }
        
        // Update all designs when global parameters change
        function updateAllDesigns() {
            updateMaterialProperties();
            updateLoadingConditions();
            updateSlabDesign();
            updateBeamDesign();
            updateColumnDesign();
            updateFootingDesign();
            updateTorsionChecks();
            updateIrregularityChecks();
            updateFlowDiagram();
        }
        
        // Update material properties
        function updateMaterialProperties() {
            designData.materials = {
                concreteGrade: parseInt(document.getElementById('concreteGrade').value),
                steelGrade: parseInt(document.getElementById('steelGrade').value),
                fck: parseInt(document.getElementById('concreteGrade').value),
                fy: parseInt(document.getElementById('steelGrade').value)
            };
        }
        
        // Update loading conditions
        function updateLoadingConditions() {
            designData.loading = {
                liveLoad: parseFloat(document.getElementById('liveLoad').value),
                floorFinishLoad: parseFloat(document.getElementById('floorFinishLoad').value),
                wallLoad: parseFloat(document.getElementById('wallLoad').value),
                soilCapacity: parseFloat(document.getElementById('soilCapacity').value),
                floorHeight: parseFloat(document.getElementById('floorHeight').value),
                seismicZone: document.getElementById('seismicZone').value,
                seismicZoneFactor: parseFloat(document.getElementById('seismicZone').value)
            };
        }
        
        // Slab design calculations
        function updateSlabDesign() {
            const slabThickness = parseFloat(document.getElementById('slabThickness').value);
            const spanX = parseFloat(document.getElementById('slabSpanX').value);
            const spanY = parseFloat(document.getElementById('slabSpanY').value);
            const supportCondition = document.getElementById('slabSupportCondition').value;
            
            // Store slab data
            designData.slab = {
                thickness: slabThickness,
                spanX: spanX,
                spanY: spanY,
                supportCondition: supportCondition,
                effectiveDepth: slabThickness - 25 // 25mm cover
            };
            
            // Calculate loads based on global parameters
            const selfWeight = (slabThickness/1000) * 25; // 25 kN/m¬≥ for concrete
            const totalDL = selfWeight + designData.loading.floorFinishLoad;
            const totalLL = designData.loading.liveLoad;
            const factoredLoad = 1.5 * (totalDL + totalLL);
            
            // Calculate moments based on support condition
            const ratio = spanY / spanX;
            let alphaX, alphaY;
            
            // Moment coefficients based on support condition (simplified)
            if (supportCondition === "all") {
                // All edges continuous
                if (ratio < 1.1) {
                    alphaX = 0.024;
                    alphaY = 0.024;
                } else if (ratio < 1.2) {
                    alphaX = 0.032;
                    alphaY = 0.024;
                } else {
                    alphaX = 0.045;
                    alphaY = 0.020;
                }
            } else if (supportCondition === "twoAdjacent") {
                // Two adjacent edges discontinuous
                if (ratio < 1.1) {
                    alphaX = 0.035;
                    alphaY = 0.035;
                } else if (ratio < 1.2) {
                    alphaX = 0.047;
                    alphaY = 0.035;
                } else {
                    alphaX = 0.060;
                    alphaY = 0.028;
                }
            } else if (supportCondition === "oneLong") {
                // One long edge discontinuous
                if (ratio < 1.1) {
                    alphaX = 0.028;
                    alphaY = 0.028;
                } else if (ratio < 1.2) {
                    alphaX = 0.037;
                    alphaY = 0.028;
                } else {
                    alphaX = 0.048;
                    alphaY = 0.022;
                }
            } else if (supportCondition === "oneShort") {
                // One short edge discontinuous
                if (ratio < 1.1) {
                    alphaX = 0.039;
                    alphaY = 0.039;
                } else if (ratio < 1.2) {
                    alphaX = 0.052;
                    alphaY = 0.039;
                } else {
                    alphaX = 0.064;
                    alphaY = 0.030;
                }
            } else {
                // All edges discontinuous
                if (ratio < 1.1) {
                    alphaX = 0.056;
                    alphaY = 0.056;
                } else if (ratio < 1.2) {
                    alphaX = 0.072;
                    alphaY = 0.056;
                } else {
                    alphaX = 0.084;
                    alphaY = 0.042;
                }
            }
            
            const Mx = alphaX * factoredLoad * spanX * spanX;
            const My = alphaY * factoredLoad * spanX * spanX;
            
            // Calculate capacities
            const ptX = calculatePt(Mx*1e6, 1000, designData.slab.effectiveDepth, designData.materials.fck, designData.materials.fy);
            const ptY = calculatePt(My*1e6, 1000, designData.slab.effectiveDepth, designData.materials.fck, designData.materials.fy);
            
            const capacityX = calculateMomentCapacity(ptX, 1000, designData.slab.effectiveDepth, designData.materials.fck, designData.materials.fy);
            const capacityY = calculateMomentCapacity(ptY, 1000, designData.slab.effectiveDepth, designData.materials.fck, designData.materials.fy);
            
            // Deflection check
            const basicLd = ratio <= 2 ? 26 : 20;
            const modificationFactor = 1.4; // Simplified
            const allowedLd = basicLd * modificationFactor;
            const actualLd = (spanX*1000)/designData.slab.effectiveDepth;
            
            // Shear calculation (simplified)
            const shearForce = factoredLoad * spanX / 2;
            const shearCapacity = calculateShearCapacity(1000, designData.slab.effectiveDepth, designData.materials.fck, ptX);
            
            // Update display
            document.getElementById('slabMomentX').textContent = Mx.toFixed(2) + ' kNm/m';
            document.getElementById('slabMomentXLimit').textContent = capacityX.toFixed(2) + ' kNm/m';
            document.getElementById('slabMomentY').textContent = My.toFixed(2) + ' kNm/m';
            document.getElementById('slabMomentYLimit').textContent = capacityY.toFixed(2) + ' kNm/m';
            document.getElementById('slabDeflection').textContent = 'L/' + Math.round(actualLd);
            document.getElementById('slabShear').textContent = shearForce.toFixed(2) + ' kN/m';
            document.getElementById('slabShearLimit').textContent = shearCapacity.toFixed(2) + ' kN/m';
            
            // Update status
            updateStatus('slabMomentXStatus', Mx, capacityX);
            updateStatus('slabMomentYStatus', My, capacityY);
            updateStatus('slabDeflectionStatus', actualLd, allowedLd, true);
            updateStatus('slabShearStatus', shearForce, shearCapacity);
            
            // Update reinforcement
            const reinforcementX = calculateReinforcement(Mx*1e6, 1000, designData.slab.effectiveDepth, designData.materials.fck, designData.materials.fy);
            const reinforcementY = calculateReinforcement(My*1e6, 1000, designData.slab.effectiveDepth, designData.materials.fck, designData.materials.fy);
            
            document.getElementById('slabReinforcementX').textContent = reinforcementX;
            document.getElementById('slabReinforcementY').textContent = reinforcementY;
            
            // Update flow diagram
            updateFlowDiagram();
        }
        
        // Beam design calculations
        function updateBeamDesign() {
            const width = parseFloat(document.getElementById('beamWidth').value);
            const depth = parseFloat(document.getElementById('beamDepth').value);
            const span = parseFloat(document.getElementById('beamSpan').value);
            const supportCondition = document.getElementById('beamSupportCondition').value;
            
            // Store beam data
            designData.beam = {
                width: width,
                depth: depth,
                span: span,
                supportCondition: supportCondition,
                effectiveDepth: depth - 50 // 50mm cover
            };
            
            // Calculate loads from slab (tributary area) using global parameters
            const slabLoad = designData.slab ? 
                1.5 * ((designData.slab.thickness/1000 * 25 + designData.loading.floorFinishLoad + designData.loading.liveLoad) * (designData.slab.spanX/2)) : 
                30.0; // Default if slab not calculated
            
            // Calculate self weight using global parameters
            const selfWeight = 1.5 * (width/1000) * (depth/1000) * 25;
            
            // Total factored load including wall load from global parameters
            const totalLoad = slabLoad + selfWeight + (1.5 * designData.loading.wallLoad);
            
            // Calculate moment and shear based on support condition
            let moment, shear;
            
            if (supportCondition === "simplySupported") {
                moment = totalLoad * span * span / 8;
                shear = totalLoad * span / 2;
            } else if (supportCondition === "continuous") {
                moment = totalLoad * span * span / 10; // Simplified
                shear = totalLoad * span / 2;
            } else if (supportCondition === "cantilever") {
                moment = totalLoad * span * span / 2;
                shear = totalLoad * span;
            } else {
                // Fixed at both ends
                moment = totalLoad * span * span / 12;
                shear = totalLoad * span / 2;
            }
            
            // Calculate capacities using current material properties
            const pt = calculatePt(moment*1e6, width, designData.beam.effectiveDepth, designData.materials.fck, designData.materials.fy);
            const momentCapacity = calculateMomentCapacity(pt, width, designData.beam.effectiveDepth, designData.materials.fck, designData.materials.fy);
            const shearCapacity = calculateShearCapacity(width, designData.beam.effectiveDepth, designData.materials.fck, pt);
            
            // Deflection check (simplified)
            const basicLd = 20;
            const modificationFactor = 1.0; // Simplified
            const allowedLd = basicLd * modificationFactor;
            const actualLd = (span*1000)/designData.beam.effectiveDepth;
            
            // Ductility check (IS 13920)
            const ductilityRatio = (width * depth * designData.materials.fck) / (100 * designData.materials.fy);
            
            // Update display
            document.getElementById('beamMoment').textContent = moment.toFixed(2) + ' kNm';
            document.getElementById('beamMomentLimit').textContent = momentCapacity.toFixed(2) + ' kNm';
            document.getElementById('beamShear').textContent = shear.toFixed(2) + ' kN';
            document.getElementById('beamShearLimit').textContent = shearCapacity.toFixed(2) + ' kN';
            document.getElementById('beamDeflection').textContent = 'L/' + Math.round(actualLd);
            document.getElementById('beamDuctility').textContent = ductilityRatio.toFixed(2);
            
            // Update status
            updateStatus('beamMomentStatus', moment, momentCapacity);
            updateStatus('beamShearStatus', shear, shearCapacity);
            updateStatus('beamDeflectionStatus', actualLd, allowedLd, true);
            
            if (ductilityRatio <= 0.48) {
                document.getElementById('beamDuctilityStatus').innerHTML = '<span class="status-badge status-safe">OK</span>';
            } else {
                document.getElementById('beamDuctilityStatus').innerHTML = '<span class="status-badge status-danger">Fail</span>';
            }
            
            // Update reinforcement
            const mainReinforcement = calculateBeamReinforcement(moment*1e6, width, designData.beam.effectiveDepth, designData.materials.fck, designData.materials.fy);
            const stirrups = calculateBeamStirrups(shear*1e3, width, designData.beam.effectiveDepth, designData.materials.fck, pt);
            
            document.getElementById('beamMainReinforcement').textContent = mainReinforcement;
            document.getElementById('beamStirrups').textContent = stirrups;
            
            // Update flow diagram
            updateFlowDiagram();
        }
        
        // Column design calculations
        function updateColumnDesign() {
            const width = parseFloat(document.getElementById('columnWidth').value);
            const depth = parseFloat(document.getElementById('columnDepth').value);
            const height = parseFloat(document.getElementById('columnHeight').value);
            const columnType = document.getElementById('columnType').value;
            
            // Store column data
            designData.column = {
                width: width,
                depth: depth,
                height: height,
                type: columnType
            };
            
            // Calculate loads from beams (tributary area) using global parameters
            const beamLoad = designData.beam ? 
                2 * (1.5 * ((designData.slab.thickness/1000 * 25 + designData.loading.floorFinishLoad + designData.loading.liveLoad) * (designData.slab.spanX/2) * (designData.beam.span/2))) : 
                500.0; // Default if beam not calculated
            
            // Calculate self weight using global parameters
            const selfWeight = 1.5 * (width/1000) * (depth/1000) * height * 25;
            
            // Total factored load
            const axialLoad = beamLoad + selfWeight;
            
            // Moments from ETABS analysis (simplified)
            const momentX = 0.1 * axialLoad * height / 2;
            const momentY = 0.07 * axialLoad * height / 2;
            
            // Calculate capacities using current material properties
            const axialCapacity = calculateAxialCapacity(width, depth, designData.materials.fck, 2.0); // 2% steel
            const momentCapacityX = calculateMomentCapacityColumn(width, depth, designData.materials.fck, designData.materials.fy, 2.0);
            const momentCapacityY = calculateMomentCapacityColumn(depth, width, designData.materials.fck, designData.materials.fy, 2.0);
            
            // Slenderness check
            const effectiveLength = 0.65 * height * 1000; // mm
            const slendernessX = effectiveLength / depth;
            const slendernessY = effectiveLength / width;
            const isShort = slendernessX < 12 && slendernessY < 12;
            
            // Ductility check (IS 13920)
            const ductilityRatio = 0.035; // Simplified
            
            // Update display
            document.getElementById('columnAxial').textContent = axialLoad.toFixed(2) + ' kN';
            document.getElementById('columnAxialLimit').textContent = axialCapacity.toFixed(2) + ' kN';
            document.getElementById('columnMomentX').textContent = momentX.toFixed(2) + ' kNm';
            document.getElementById('columnMomentXLimit').textContent = momentCapacityX.toFixed(2) + ' kNm';
            document.getElementById('columnMomentY').textContent = momentY.toFixed(2) + ' kNm';
            document.getElementById('columnMomentYLimit').textContent = momentCapacityY.toFixed(2) + ' kNm';
            document.getElementById('columnSlenderness').textContent = Math.max(slendernessX, slendernessY).toFixed(2);
            document.getElementById('columnDuctility').textContent = ductilityRatio.toFixed(3);
            
            // Update status
            updateStatus('columnAxialStatus', axialLoad, axialCapacity);
            updateStatus('columnMomentXStatus', momentX, momentCapacityX);
            updateStatus('columnMomentYStatus', momentY, momentCapacityY);
            
            if (isShort) {
                document.getElementById('columnSlendernessStatus').innerHTML = '<span class="status-badge status-safe">Short Column</span>';
            } else {
                document.getElementById('columnSlendernessStatus').innerHTML = '<span class="status-badge status-warning">Slender Column</span>';
            }
            
            if (ductilityRatio >= 0.035) {
                document.getElementById('columnDuctilityStatus').innerHTML = '<span class="status-badge status-safe">OK</span>';
            } else {
                document.getElementById('columnDuctilityStatus').innerHTML = '<span class="status-badge status-danger">Fail</span>';
            }
            
            // Update reinforcement
            const mainReinforcement = calculateColumnReinforcement(width, depth, axialLoad*1e3, momentX*1e6, momentY*1e6, designData.materials.fck, designData.materials.fy);
            const ties = calculateColumnTies(width, depth, designData.materials.fy, columnType);
            
            document.getElementById('columnMainReinforcement').textContent = mainReinforcement;
            document.getElementById('columnTies').textContent = ties;
            
            // Update flow diagram
            updateFlowDiagram();
        }
        
        // Footing design calculations
        function updateFootingDesign() {
            const length = parseFloat(document.getElementById('footingLength').value);
            const width = parseFloat(document.getElementById('footingWidth').value);
            const thickness = parseFloat(document.getElementById('footingThickness').value);
            const soilType = document.getElementById('soilType').value;
            
            // Store footing data
            designData.footing = {
                length: length,
                width: width,
                thickness: thickness,
                soilType: soilType,
                effectiveDepth: thickness - 50 // 50mm cover
            };
            
            // Get column load from global parameters
            const columnLoad = designData.column ? 
                (2 * (1.5 * ((designData.slab.thickness/1000 * 25 + designData.loading.floorFinishLoad + designData.loading.liveLoad) * (designData.slab.spanX/2) * (designData.beam.span/2))) +
                (1.5 * (designData.column.width/1000) * (designData.column.depth/1000) * designData.column.height * 25)) : 
                800.0; // Default if column not calculated
            
            // Calculate self weight
            const selfWeight = length * width * (thickness/1000) * 25;
            
            // Total load
            const totalLoad = columnLoad + selfWeight;
            
            // Soil pressure using soil capacity from global parameters
            const area = length * width;
            const pressure = totalLoad / area;
            
            // Calculate capacities using current material properties
            const momentCapacity = calculateMomentCapacity(0.2, 1000, designData.footing.effectiveDepth, designData.materials.fck, designData.materials.fy); // 0.2% min steel
            const shearCapacity = calculateShearCapacity(1000, designData.footing.effectiveDepth, designData.materials.fck, 0.2);
            const punchingCapacity = calculatePunchingCapacity(designData.column.width, designData.column.depth, designData.footing.effectiveDepth, designData.materials.fck);
            
            // Moments and shears (simplified)
            const cantileverLength = (length - (designData.column.depth/1000)) / 2;
            const moment = 1.5 * pressure * cantileverLength * cantileverLength / 2;
            const shear = 1.5 * pressure * cantileverLength;
            const punchingShear = totalLoad;
            
            // Update display
            document.getElementById('footingPressure').textContent = pressure.toFixed(2) + ' kN/m¬≤';
            document.getElementById('footingPressureLimit').textContent = designData.loading.soilCapacity + ' kN/m¬≤';
            document.getElementById('footingMoment').textContent = moment.toFixed(2) + ' kNm/m';
            document.getElementById('footingMomentLimit').textContent = momentCapacity.toFixed(2) + ' kNm/m';
            document.getElementById('footingShear').textContent = shear.toFixed(2) + ' kN/m';
            document.getElementById('footingShearLimit').textContent = shearCapacity.toFixed(2) + ' kN/m';
            document.getElementById('footingPunching').textContent = punchingShear.toFixed(2) + ' kN';
            document.getElementById('footingPunchingLimit').textContent = punchingCapacity.toFixed(2) + ' kN';
            
            // Update status
            updateStatus('footingPressureStatus', pressure, designData.loading.soilCapacity);
            updateStatus('footingMomentStatus', moment, momentCapacity);
            updateStatus('footingShearStatus', shear, shearCapacity);
            updateStatus('footingPunchingStatus', punchingShear, punchingCapacity);
            
            // Update reinforcement
            const bottomReinforcement = calculateReinforcement(moment*1e6, 1000, designData.footing.effectiveDepth, designData.materials.fck, designData.materials.fy);
            const topReinforcement = '12mm @ 200mm c/c'; // Minimum top reinforcement
            
            document.getElementById('footingBottomReinforcement').textContent = bottomReinforcement;
            document.getElementById('footingTopReinforcement').textContent = topReinforcement;
            
            // Update foundation type based on soil type and global parameters
            let foundationType = "Shallow Foundation";
            let recommendation = `For ${soilType} soil with bearing capacity of ${designData.loading.soilCapacity} kN/m¬≤, isolated footing is recommended.`;
            
            if (soilType === "medium") {
                if (designData.loading.soilCapacity < 100) {
                    foundationType = "Consider Raft Foundation";
                    recommendation = "For medium soil with bearing capacity below 100 kN/m¬≤, raft foundation is recommended to distribute loads evenly.";
                }
            } else if (soilType === "soft") {
                if (designData.loading.soilCapacity < 75) {
                    foundationType = "Pile Foundation Required";
                    recommendation = "For soft soil with bearing capacity below 75 kN/m¬≤, pile foundation is recommended to transfer loads to deeper, more stable strata.";
                } else {
                    foundationType = "Raft Foundation Recommended";
                    recommendation = "For soft soil, raft foundation is recommended to distribute loads over larger area.";
                }
            }
            
            document.getElementById('foundationTypeDisplay').textContent = "Foundation Type: " + foundationType;
            document.getElementById('foundationRecText').textContent = recommendation;
            
            // Update flow diagram
            updateFlowDiagram();
        }
        
        // Torsional irregularity checks
        function updateTorsionChecks() {
            const lengthX = parseFloat(document.getElementById('buildingLengthX').value);
            const widthY = parseFloat(document.getElementById('buildingWidthY').value);
            const cmX = parseFloat(document.getElementById('centerMassX').value);
            const cmY = parseFloat(document.getElementById('centerMassY').value);
            const csX = parseFloat(document.getElementById('centerStiffnessX').value);
            const csY = parseFloat(document.getElementById('centerStiffnessY').value);
            
            // Store torsion data
            designData.torsion = {
                lengthX: lengthX,
                widthY: widthY,
                cmX: cmX,
                cmY: cmY,
                csX: csX,
                csY: csY
            };
            
            // Calculate eccentricities
            const eccX = Math.abs(cmX - csX);
            const eccY = Math.abs(cmY - csY);
            
            // Calculate radii of gyration
            const radiusX = 0.2 * lengthX;
            const radiusY = 0.2 * widthY;
            
            // Calculate torsional irregularity ratios
            const ratioX = eccX / radiusX;
            const ratioY = eccY / radiusY;
            const maxRatio = Math.max(ratioX, ratioY);
            
            // Update display
            document.getElementById('eccentricityX').textContent = eccX.toFixed(2) + ' m';
            document.getElementById('eccentricityY').textContent = eccY.toFixed(2) + ' m';
            document.getElementById('radiusX').textContent = radiusX.toFixed(2) + ' m';
            document.getElementById('radiusY').textContent = radiusY.toFixed(2) + ' m';
            document.getElementById('torsionRatioX').textContent = ratioX.toFixed(3);
            document.getElementById('torsionRatioY').textContent = ratioY.toFixed(3);
            
            // Update status
            if (maxRatio <= 0.15) {
                document.getElementById('torsionStatus').innerHTML = '<span class="status-badge status-safe">Regular</span>';
                document.getElementById('torsionRecommendations').style.display = 'none';
                document.getElementById('torsionIrregularityPresent').textContent = 'No';
                document.getElementById('torsionIrregularityStatus').innerHTML = '<span class="status-badge status-safe">OK</span>';
            } else {
                document.getElementById('torsionStatus').innerHTML = '<span class="status-badge status-warning">Irregular</span>';
                document.getElementById('torsionRecommendations').style.display = 'block';
                document.getElementById('torsionIrregularityPresent').textContent = 'Yes';
                document.getElementById('torsionIrregularityStatus').innerHTML = '<span class="status-badge status-warning">Check</span>';
            }
        }
        
        // Structural irregularity checks
        function updateIrregularityChecks() {
            const massIrregularity = document.getElementById('massIrregularity').value;
            const verticalGeometric = document.getElementById('verticalGeometricIrregularity').value;
            const stiffnessIrregularity = document.getElementById('stiffnessIrregularity').value;
            const verticalDiscontinuity = document.getElementById('verticalDiscontinuity').value;
            const reentrantCorners = document.getElementById('reentrantCorners').value;
            
            // Store irregularity data
            designData.irregularity = {
                massIrregularity: massIrregularity,
                verticalGeometric: verticalGeometric,
                stiffnessIrregularity: stiffnessIrregularity,
                verticalDiscontinuity: verticalDiscontinuity,
                reentrantCorners: reentrantCorners
            };
            
            // Update display
            document.getElementById('massIrregularityPresent').textContent = massIrregularity === 'yes' ? 'Yes' : 'No';
            document.getElementById('verticalGeometricIrregularityPresent').textContent = verticalGeometric === 'yes' ? 'Yes' : 'No';
            document.getElementById('stiffnessIrregularityPresent').textContent = stiffnessIrregularity === 'yes' ? 'Yes' : 'No';
            document.getElementById('verticalDiscontinuityPresent').textContent = verticalDiscontinuity === 'yes' ? 'Yes' : 'No';
            document.getElementById('reentrantCornersPresent').textContent = reentrantCorners === 'yes' ? 'Yes' : 'No';
            
            // Update status
            updateIrregularityStatus('massIrregularityStatus', massIrregularity);
            updateIrregularityStatus('verticalGeometricIrregularityStatus', verticalGeometric);
            updateIrregularityStatus('stiffnessIrregularityStatus', stiffnessIrregularity);
            updateIrregularityStatus('verticalDiscontinuityStatus', verticalDiscontinuity);
            updateIrregularityStatus('reentrantCornersStatus', reentrantCorners);
            
            // Show recommendations if any irregularity exists
            if (massIrregularity === 'yes' || verticalGeometric === 'yes' || stiffnessIrregularity === 'yes' || 
                verticalDiscontinuity === 'yes' || reentrantCorners === 'yes') {
                document.getElementById('irregularityRecommendations').style.display = 'block';
            } else {
                document.getElementById('irregularityRecommendations').style.display = 'none';
            }
        }
        
        function updateIrregularityStatus(elementId, value) {
            const element = document.getElementById(elementId);
            if (value === 'yes') {
                element.innerHTML = '<span class="status-badge status-warning">Check</span>';
            } else {
                element.innerHTML = '<span class="status-badge status-safe">OK</span>';
            }
        }
        
        // Update flow diagram with current status
        function updateFlowDiagram() {
            if (designData.slab) {
                document.getElementById('flow-slab-thickness').textContent = designData.slab.thickness;
                
                // Simplified slab status check
                const slabStatus = document.getElementById('slabDeflectionStatus').textContent.includes('Safe') ? 'Safe' : 'Warning';
                document.getElementById('flow-slab-status').textContent = slabStatus;
                document.getElementById('flow-slab-status').className = slabStatus === 'Safe' ? 'status-badge status-safe' : 'status-badge status-warning';
            }
            
            if (designData.beam) {
                document.getElementById('flow-beam-size').textContent = designData.beam.width + '√ó' + designData.beam.depth;
                
                // Simplified beam status check
                const beamStatus = document.getElementById('beamMomentStatus').textContent.includes('Safe') ? 'Safe' : 'Warning';
                document.getElementById('flow-beam-status').textContent = beamStatus;
                document.getElementById('flow-beam-status').className = beamStatus === 'Safe' ? 'status-badge status-safe' : 'status-badge status-warning';
            }
            
            if (designData.column) {
                document.getElementById('flow-column-size').textContent = designData.column.width + '√ó' + designData.column.depth;
                
                // Simplified column status check
                const columnStatus = document.getElementById('columnAxialStatus').textContent.includes('Safe') ? 'Safe' : 'Warning';
                document.getElementById('flow-column-status').textContent = columnStatus;
                document.getElementById('flow-column-status').className = columnStatus === 'Safe' ? 'status-badge status-safe' : 'status-badge status-warning';
            }
            
            if (designData.footing) {
                document.getElementById('flow-footing-size').textContent = designData.footing.length + '√ó' + designData.footing.width;
                
                // Simplified footing status check
                const footingStatus = document.getElementById('footingPressureStatus').textContent.includes('Safe') ? 'Safe' : 'Warning';
                document.getElementById('flow-footing-status').textContent = footingStatus;
                document.getElementById('flow-footing-status').className = footingStatus === 'Safe' ? 'status-badge status-safe' : 'status-badge status-warning';
            }
        }
        
        // Helper function to update status indicators
        function updateStatus(elementId, value, limit, reverse = false) {
            const element = document.getElementById(elementId);
            const ratio = value / limit;
            
            if ((!reverse && value <= limit) || (reverse && value >= limit)) {
                element.innerHTML = '<span class="status-badge status-safe">Safe</span>';
            } else if (ratio < 1.1 || (reverse && ratio > 0.9)) {
                element.innerHTML = '<span class="status-badge status-warning">Warning</span>';
            } else {
                element.innerHTML = '<span class="status-badge status-danger">Fail</span>';
            }
        }
        
        // Size adjustment functions
        function adjustSlabThickness(change) {
            const input = document.getElementById('slabThickness');
            input.value = parseInt(input.value) + change;
            updateSlabDesign();
        }
        
        function adjustBeamWidth(change) {
            const input = document.getElementById('beamWidth');
            input.value = parseInt(input.value) + change;
            updateBeamDesign();
        }
        
        function adjustBeamDepth(change) {
            const input = document.getElementById('beamDepth');
            input.value = parseInt(input.value) + change;
            updateBeamDesign();
        }
        
        function adjustColumnWidth(change) {
            const input = document.getElementById('columnWidth');
            input.value = parseInt(input.value) + change;
            updateColumnDesign();
        }
        
        function adjustColumnDepth(change) {
            const input = document.getElementById('columnDepth');
            input.value = parseInt(input.value) + change;
            updateColumnDesign();
        }
        
        function adjustFootingLength(change) {
            const input = document.getElementById('footingLength');
            input.value = (parseFloat(input.value) + change).toFixed(1);
            updateFootingDesign();
        }
        
        function adjustFootingWidth(change) {
            const input = document.getElementById('footingWidth');
            input.value = (parseFloat(input.value) + change).toFixed(1);
            updateFootingDesign();
        }
        
        function adjustFootingThickness(change) {
            const input = document.getElementById('footingThickness');
            input.value = parseInt(input.value) + change;
            updateFootingDesign();
        }
        
        // Soil type selection
        function selectSoilType(element, soilType) {
            // Remove selected class from all options
            const options = document.querySelectorAll('.soil-type-option');
            options.forEach(opt => opt.classList.remove('selected'));
            
            // Add selected class to clicked option
            element.classList.add('selected');
            
            // Update hidden input
            document.getElementById('soilType').value = soilType;
            updateFootingDesign();
        }
        
        // Optimization functions
        function optimizeSlab() {
            // Simple optimization - increase thickness if deflection fails
            if (document.getElementById('slabDeflectionStatus').textContent.includes('Fail') || 
                document.getElementById('slabDeflectionStatus').textContent.includes('Warning')) {
                adjustSlabThickness(10);
            }
        }
        
        function optimizeBeam() {
            // Simple optimization - increase depth if moment fails
            if (document.getElementById('beamMomentStatus').textContent.includes('Fail') || 
                document.getElementById('beamMomentStatus').textContent.includes('Warning')) {
                adjustBeamDepth(25);
            }
        }
        
        function optimizeColumn() {
            // Simple optimization - increase size if axial fails
            if (document.getElementById('columnAxialStatus').textContent.includes('Fail') || 
                document.getElementById('columnAxialStatus').textContent.includes('Warning')) {
                adjustColumnWidth(25);
                adjustColumnDepth(25);
            }
        }
        
        function optimizeFooting() {
            // Simple optimization - increase size if pressure fails
            if (document.getElementById('footingPressureStatus').textContent.includes('Fail') || 
                document.getElementById('footingPressureStatus').textContent.includes('Warning')) {
                adjustFootingLength(0.1);
                adjustFootingWidth(0.1);
            }
        }
        
        // Calculation helper functions
        function calculatePt(mu, b, d, fck, fy) {
            // Simplified pt calculation
            const muBd2 = mu / (b * d * d);
            let pt = 0;
            
            if (fck == 20) {
                if (muBd2 < 0.138) pt = 0.12;
                else if (muBd2 < 0.42) pt = 0.2;
                else if (muBd2 < 0.72) pt = 0.4;
                else if (muBd2 < 1.02) pt = 0.6;
                else pt = 0.8;
            } else if (fck == 25) {
                if (muBd2 < 0.138) pt = 0.12;
                else if (muBd2 < 0.42) pt = 0.2;
                else if (muBd2 < 0.72) pt = 0.4;
                else if (muBd2 < 1.02) pt = 0.6;
                else pt = 0.8;
            } else if (fck == 30) {
                if (muBd2 < 0.138) pt = 0.12;
                else if (muBd2 < 0.42) pt = 0.2;
                else if (muBd2 < 0.72) pt = 0.4;
                else if (muBd2 < 1.02) pt = 0.6;
                else pt = 0.8;
            }
            
            return pt;
        }
        
        function calculateMomentCapacity(pt, b, d, fck, fy) {
            // Simplified moment capacity calculation
            const ast = (pt/100) * b * d;
            const xu = (0.87 * fy * ast) / (0.36 * fck * b);
            const mur = 0.36 * fck * b * xu * (d - 0.42 * xu) / 1e6;
            return mur;
        }
        
        function calculateShearCapacity(b, d, fck, pt) {
            // Simplified shear capacity calculation
            const tc = 0.62; // For M25 and pt=1.0%
            const vuc = tc * b * d / 1000; // kN
            const vus = 0.87 * 415 * (2 * 50.3) * d / (150 * 1000); // 2-legged 8mm @150mm
            return vuc + vus;
        }
        
        function calculateAxialCapacity(b, D, fck, pt) {
            // Simplified axial capacity calculation
            const ag = b * D;
            const asc = (pt/100) * ag;
            const ac = ag - asc;
            const pu = (0.4 * fck * ac + 0.67 * 415 * asc) / 1000;
            return pu;
        }
        
        function calculateMomentCapacityColumn(b, D, fck, fy, pt) {
            // Simplified moment capacity for column
            return 0.1 * fck * b * D * D / 1e6;
        }
        
        function calculatePunchingCapacity(colWidth, colDepth, effDepth, fck) {
            // Simplified punching shear capacity
            const perimeter = 2 * (colWidth + colDepth + 2 * effDepth);
            const shearStrength = 0.25 * Math.sqrt(fck);
            return perimeter * effDepth * shearStrength / 1000; // kN
        }
        
        function calculateReinforcement(mu, b, d, fck, fy) {
            // Simplified reinforcement calculation
            const pt = calculatePt(mu, b, d, fck, fy);
            const ast = Math.ceil((pt/100) * b * d);
            
            // Choose practical reinforcement
            if (ast < 300) return '10mm @ 150mm c/c';
            else if (ast < 400) return '10mm @ 125mm c/c';
            else if (ast < 500) return '12mm @ 150mm c/c';
            else if (ast < 600) return '12mm @ 125mm c/c';
            else return '12mm @ 100mm c/c';
        }
        
        function calculateBeamReinforcement(mu, b, d, fck, fy) {
            // Simplified beam reinforcement calculation
            const pt = calculatePt(mu, b, d, fck, fy);
            const ast = Math.ceil((pt/100) * b * d);
            
            // Choose practical reinforcement
            const barSize = ast < 1000 ? 16 : 20;
            const numBars = Math.ceil(ast / (Math.PI * barSize * barSize / 4));
            
            return numBars + '-' + barSize + 'mm dia';
        }
        
        function calculateBeamStirrups(vu, b, d, fck, pt) {
            // Simplified stirrup calculation
            return '8mm @ 150mm c/c';
        }
        
        function calculateColumnReinforcement(b, D, pu, mux, muy, fck, fy) {
            // Simplified column reinforcement
            const ast = Math.max(0.8 * b * D / 100, 4 * Math.PI * 16 * 16 / 4); // 0.8% min
            const numBars = Math.ceil(ast / (Math.PI * 16 * 16 / 4));
            
            return numBars + '-16mm dia';
        }
        
        function calculateColumnTies(b, D, fy, columnType) {
            // Simplified tie calculation
            const spacing = Math.min(16 * 16, 300, b, D); // 16mm bars
            
            if (columnType === "spiral") {
                return '6mm spiral @ ' + Math.min(75, 0.25 * Math.min(b, D)) + 'mm pitch';
            } else {
                return '8mm @ ' + spacing + 'mm c/c';
            }
        }
        
        // Report generation
        function generateReport() {
            // Set report date
            const reportDate = new Date().toLocaleDateString();
            document.getElementById('reportDate').textContent = reportDate;
            
            // Set seismic zone
            const seismicZone = document.getElementById('seismicZone').options[document.getElementById('seismicZone').selectedIndex].text;
            document.getElementById('reportSeismicZone').textContent = seismicZone;
            
            // Generate summary
            let summaryHTML = `
                <h3>Structural Elements Summary</h3>
                <table>
                    <tr>
                        <th>Element</th>
                        <th>Size</th>
                        <th>Status</th>
                    </tr>
                    <tr>
                        <td>Slab</td>
                        <td>${designData.slab.thickness}mm thick</td>
                        <td>${document.getElementById('slabDeflectionStatus').textContent.includes('Safe') ? '‚úîÔ∏è Safe' : '‚ö†Ô∏è Check'}</td>
                    </tr>
                    <tr>
                        <td>Beam</td>
                        <td>${designData.beam.width}√ó${designData.beam.depth}mm</td>
                        <td>${document.getElementById('beamMomentStatus').textContent.includes('Safe') ? '‚úîÔ∏è Safe' : '‚ö†Ô∏è Check'}</td>
                    </tr>
                    <tr>
                        <td>Column</td>
                        <td>${designData.column.width}√ó${designData.column.depth}mm</td>
                        <td>${document.getElementById('columnAxialStatus').textContent.includes('Safe') ? '‚úîÔ∏è Safe' : '‚ö†Ô∏è Check'}</td>
                    </tr>
                    <tr>
                        <td>Footing</td>
                        <td>${designData.footing.length}√ó${designData.footing.width}m (${designData.footing.soilType} soil)</td>
                        <td>${document.getElementById('footingPressureStatus').textContent.includes('Safe') ? '‚úîÔ∏è Safe' : '‚ö†Ô∏è Check'}</td>
                    </tr>
                </table>
                
                <h3>Material Properties</h3>
                <p>Concrete: M${designData.materials.fck} | Steel: Fe${designData.materials.fy}</p>
                
                <h3>Load Conditions</h3>
                <p>Live Load: ${designData.loading.liveLoad} kN/m¬≤ | Floor Finish: ${designData.loading.floorFinishLoad} kN/m¬≤</p>
                <p>Wall Load: ${designData.loading.wallLoad} kN/m | Soil Capacity: ${designData.loading.soilCapacity} kN/m¬≤</p>
            `;
            document.getElementById('reportSummary').innerHTML = summaryHTML;
            
            // Generate detailed calculations
            let calculationsHTML = `
                <h3>Slab Design</h3>
                <p>Thickness: ${designData.slab.thickness}mm | Spans: ${designData.slab.spanX}m √ó ${designData.slab.spanY}m</p>
                <p>Support Condition: ${designData.slab.supportCondition.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}</p>
                <p>Reinforcement: ${document.getElementById('slabReinforcementX').textContent} & ${document.getElementById('slabReinforcementY').textContent}</p>
                <p>Deflection: ${document.getElementById('slabDeflection').textContent} (Limit: L/250)</p>
                <p>Cover: 20mm nominal cover as per IS 456:2000</p>
                
                <h3>Beam Design</h3>
                <p>Size: ${designData.beam.width}√ó${designData.beam.depth}mm | Span: ${designData.beam.span}m</p>
                <p>Support Condition: ${designData.beam.supportCondition.replace(/([A-Z])/g, ' $1').replace(/^./, str => str.toUpperCase())}</p>
                <p>Reinforcement: ${document.getElementById('beamMainReinforcement').textContent} with ${document.getElementById('beamStirrups').textContent}</p>
                <p>Moment Capacity: ${document.getElementById('beamMomentLimit').textContent}</p>
                <p>Cover: 25mm nominal cover as per IS 456:2000</p>
                
                <h3>Column Design</h3>
                <p>Size: ${designData.column.width}√ó${designData.column.depth}mm | Height: ${designData.column.height}m</p>
                <p>Type: ${designData.column.type === "tied" ? "Tied Column" : "Spiral Column"}</p>
                <p>Reinforcement: ${document.getElementById('columnMainReinforcement').textContent} with ${document.getElementById('columnTies').textContent}</p>
                <p>Axial Capacity: ${document.getElementById('columnAxialLimit').textContent}</p>
                <p>Cover: 40mm nominal cover as per IS 13920</p>
                
                <h3>Footing Design</h3>
                <p>Size: ${designData.footing.length}√ó${designData.footing.width}m | Thickness: ${designData.footing.thickness}mm</p>
                <p>Soil Type: ${designData.footing.soilType.charAt(0).toUpperCase() + designData.footing.soilType.slice(1)}</p>
                <p>Foundation Type: ${document.getElementById('foundationTypeDisplay').textContent.replace('Foundation Type: ', '')}</p>
                <p>Reinforcement: ${document.getElementById('footingBottomReinforcement').textContent} (bottom) and ${document.getElementById('footingTopReinforcement').textContent} (top)</p>
                <p>Soil Pressure: ${document.getElementById('footingPressure').textContent} (Limit: ${document.getElementById('footingPressureLimit').textContent})</p>
                <p>Cover: 50mm nominal cover as per IS 456:2000</p>
            `;
            document.getElementById('reportCalculations').innerHTML = calculationsHTML;
            
            // Generate irregularity checks
            let irregularityHTML = `
                <h3>Torsional Irregularity</h3>
                <p>Ratio: ${document.getElementById('torsionRatioX').textContent} (X), ${document.getElementById('torsionRatioY').textContent} (Y)</p>
                <p>Status: ${document.getElementById('torsionStatus').textContent}</p>
                
                <h3>Other Irregularities</h3>
                <p>Mass Irregularity: ${document.getElementById('massIrregularityPresent').textContent}</p>
                <p>Vertical Geometric Irregularity: ${document.getElementById('verticalGeometricIrregularityPresent').textContent}</p>
                <p>Stiffness Irregularity: ${document.getElementById('stiffnessIrregularityPresent').textContent}</p>
            `;
            document.getElementById('reportIrregularity').innerHTML = irregularityHTML;
            
            // Show modal with report
            document.getElementById('modalReportContent').innerHTML = document.getElementById('report').innerHTML;
            document.getElementById('reportModal').style.display = 'block';
        }
        
        // Run full verification
        function runFullVerification() {
            const loading = document.getElementById('loadingIndicator');
            loading.style.display = 'block';
            
            // Simulate comprehensive verification
            setTimeout(() => {
                loading.style.display = 'none';
                alert("Full structural verification completed successfully!");
                
                // Update results with more detailed analysis
                document.getElementById('beamDeflection').textContent = "14.8";
                document.getElementById('beamDeflectionStatus').innerHTML = '<span class="status-badge status-safe">Safe (L/325)</span>';
                
                document.getElementById('footingPressure').textContent = "145.2 kN/m¬≤";
                document.getElementById('footingPressureStatus').innerHTML = '<span class="status-badge status-safe">Safe</span>';
                
                generateReport();
            }, 2000);
        }
        
        // Download PDF report
        function downloadPDF() {
            const doc = new jsPDF();
            
            // Add title
            doc.setFontSize(18);
            doc.text('Structural Design Verification Report', 105, 20, { align: 'center' });
            
            // Add subtitle
            doc.setFontSize(12);
            doc.text(`Generated on ${new Date().toLocaleDateString()}`, 105, 30, { align: 'center' });
            
            // Add project information
            doc.setFontSize(14);
            doc.text('Project Information', 14, 40);
            doc.setFontSize(10);
            doc.text(`Project Name: Sample Building Project`, 14, 50);
            doc.text(`Location: Mumbai, India`, 14, 55);
            doc.text(`Seismic Zone: ${document.getElementById('seismicZone').options[document.getElementById('seismicZone').selectedIndex].text}`, 14, 60);
            doc.text(`Software Used: ETABS v20`, 14, 65);

            // Add design summary
            doc.setFontSize(14);
            doc.text('Design Summary', 14, 80);
            doc.setFontSize(10);
            
            // Slab summary
            doc.text('Slab:', 14, 90);
            doc.text(`- Thickness: ${designData.slab.thickness}mm`, 20, 95);
            doc.text(`- Status: ${document.getElementById('slabDeflectionStatus').textContent.includes('Safe') ? '‚úîÔ∏è Safe' : '‚ö†Ô∏è Check'}`, 20, 100);
            
            // Beam summary
            doc.text('Beam:', 14, 110);
            doc.text(`- Size: ${designData.beam.width}√ó${designData.beam.depth}mm`, 20, 115);
            doc.text(`- Status: ${document.getElementById('beamMomentStatus').textContent.includes('Safe') ? '‚úîÔ∏è Safe' : '‚ö†Ô∏è Check'}`, 20, 120);
            
            // Column summary
            doc.text('Column:', 14, 130);
            doc.text(`- Size: ${designData.column.width}√ó${designData.column.depth}mm`, 20, 135);
            doc.text(`- Status: ${document.getElementById('columnAxialStatus').textContent.includes('Safe') ? '‚úîÔ∏è Safe' : '‚ö†Ô∏è Check'}`, 20, 140);
            
            // Footing summary
            doc.text('Footing:', 14, 150);
            doc.text(`- Size: ${designData.footing.length}√ó${designData.footing.width}m`, 20, 155);
            doc.text(`- Status: ${document.getElementById('footingPressureStatus').textContent.includes('Safe') ? '‚úîÔ∏è Safe' : '‚ö†Ô∏è Check'}`, 20, 160);
            
            // Add material properties
            doc.setFontSize(14);
            doc.text('Material Properties', 14, 175);
            doc.setFontSize(10);
            doc.text(`- Concrete: M${designData.materials.fck}`, 20, 180);
            doc.text(`- Steel: Fe${designData.materials.fy}`, 20, 185);
            
            // Add page number
            const pageCount = doc.internal.getNumberOfPages();
            for(let i = 1; i <= pageCount; i++) {
                doc.setPage(i);
                doc.setFontSize(8);
                doc.text(`Page ${i} of ${pageCount}`, 195, 285, null, null, "right");
            }
            
            // Save the PDF
            doc.save('Structural_Design_Report.pdf');
        }

        // Tab functionality
        function openTab(evt, tabName) {
            const tabContents = document.getElementsByClassName("tab-content");
            for (let i = 0; i < tabContents.length; i++) {
                tabContents[i].classList.remove("active");
            }
            
            const tabButtons = document.getElementsByClassName("tab-button");
            for (let i = 0; i < tabButtons.length; i++) {
                tabButtons[i].classList.remove("active");
            }
            
            document.getElementById(tabName).classList.add("active");
            evt.currentTarget.classList.add("active");
        }
        
        // Modal functions
        function closeModal() {
            document.getElementById('reportModal').style.display = 'none';
        }
        
        // Download calculation functions (stubs)
        function downloadSlabCalculations() {
            alert("Slab calculations download will be implemented");
        }
        
        function downloadBeamCalculations() {
            alert("Beam calculations download will be implemented");
        }
        
        function downloadColumnCalculations() {
            alert("Column calculations download will be implemented");
        }
        
        function downloadFootingCalculations() {
            alert("Footing calculations download will be implemented");
        }
        
        function downloadTorsionCalculations() {
            alert("Torsion calculations download will be implemented");
        }
        
        function downloadIrregularityCalculations() {
            alert("Irregularity calculations download will be implemented");
        }
        
        // Initialize the application when the page loads
        window.onload = function() {
            initializeDesigns();
            
            // Close modal if clicked outside
            window.onclick = function(event) {
                if (event.target == document.getElementById('reportModal')) {
                    closeModal();
                }
            }
        };
    </script>
</body>
</html>
